# Makefile for SMALL Project

## Language

[English](../Readme.md) | [简体中文](./Doc/Readme-cn.md)

## Introduction

This is the template for **SMALL** Project, which has the features like:

- Only one source file folder
- All source files are in the same folder, no sub src dirs
- Only one target to build
- added a docker container option `make builder-build` and `make builder-run` to allow developing with a container from VSCode

## How to

To use this template, copy the template file in `Template` folder to your project folder, and modify it according to comments and the following section of this manual.

## Problem description

Assume we have a project with the following folder structure, we call it a **Small Project**

- Root:
  - bin: holds target files
  - obj: holds object files
  - src: holds **all** src files
    - some-subdirs: hold **NO** src files related to the general build process. You can add some other rules to the Makefile to use these srcs, but in that case, you should take a look at **Medium Project** template.

## Work flow

When execute the command `make`, *make* will first look into the target's dependencis, which are listed in `OBJ`, withc further depend on `SRC`.

The `SRC` is generated by traversing the folder `SRC_PATH` and find all the srcfiles ended with *.c\**(which means it will consider the files ended with *.c*, *.cpp*, *.cc*, etc.)

After the `SRC` is generated, it will transform into `OBJ`:

- remove the suffix *.c\**
- remove the path prefix
- add the suffix *.o*
- add the path prefix `OBJ_PATH`

If any of the `OBJ`'s object is out-dated, it will be re-generated and futher, the `TARGET` will be re-built.

## FAQs and Discussions

1. Shall I put src files in sub-dirs of `SRC_PATH`?
    1. Basically, YES. You could put some srcs in such sub-dirs, and add some new rules to the Makefile.
    1. BUT, I do NOT recommend you to do this. Consider we have two srcs, *src/sub1/src1.c*, *src/sub2/src1.c*. They would not conflict when we write the code. But remember ALL the objects will be output tot `OBJ_PATH`, when compiling, they will conflict, and the linker will be confused.
    1. So, what if I really need to do so? Consider using the Template **MediumProject** we provided.
1. Why putting all objects into one dir?
    1. Since the project is a SMALL project, doing so will reduce the complexity of folder structure, and make it easier to clean these files.
1. What should I know when using this template under Windows
    1. You may want to set a global variable `MAKE` which points to the make tool in your system.
    1. The `TARGET` should be end with *.exe*, if not, some make tool will add it for you, which makes the `make clean` not possible to clean this target file.
    1. Do not use `find` command with UNIX-like arguments, consider using `wildcard` and the `recursive-wildcard` which we provided in **MediumProject** named as `rwildcard`.
